server{
	listen 80;
	server_name scbbsc.com www.scbbsc.com;

    listen 443 ssl default_server;
	listen [::]:443 ssl default_server;
    ssl_certificate  cert/www.scbbsc.com.crt;
    ssl_certificate_key cert/www.scbbsc.com.key;
    ssl_session_cache    shared:SSL:1m;
    ssl_session_timeout 5m;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
	ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE
	ssl_prefer_server_ciphers on;
    
	location / {
		# if (!-e $request_filename) { # 如果找不到请求的页面
        #   rewrite ^/(.*) /index.html last;
        #   break;
        # }
		root /root/webroot/family-website;
	    index index.html;
        # uwsgi_pass 127.0.0.1:8000; #将请求转发重定向到127.0.0.1的8000端口
        # include /etc/nginx/uwsgi_params;#将所有的参数转到uwsgi下
	}

    location /f-admin {
        # if (!-e $request_filename) { # 如果找不到请求的页面
        #   rewrite ^/(.*) /index.html last;
        #   break;
        # }
		alias /root/webroot/family-origin-admin;
	    index index.html;
	}

    location /b-admin {
        # if (!-e $request_filename) { # 如果找不到请求的页面
        #   rewrite ^/(.*) /index.html last;
        #   break;
        # }
		alias /root/webroot/battle-admin;
	    index index.html;
	}

    location /happy {
		alias /root/webroot/happy-camp;
	    index index.html;
	}

    location /happy-admin {
		alias /root/webroot/happy-camp-admin;
	    index index.html;
	}

    location /mini-home-admin {
		alias /root/webroot/mini-home-admin;
	    index index.html;
	}

    location /cutter {
        # if (!-e $request_filename) { # 如果找不到请求的页面
        #   rewrite ^/(.*) /index.html last;
        #   break;
        # }
		alias /root/webroot/cutter;
	    index index.html;
	}

    location /resource {
        # if (!-e $request_filename) { # 如果找不到请求的页面
        #   rewrite ^/(.*) /index.html last;
        #   break;
        # }
		alias /root/assets;
	    index index.html;
	}

    location /pages {
        # if (!-e $request_filename) { # 如果找不到请求的页面
        #   rewrite ^/(.*) /index.html last;
        #   break;
        # }
		alias /root/pages;
	    index index.html;
	}

    location ^~/api/ {
        rewrite ^/api/(.*) /$1 break;
        uwsgi_pass 127.0.0.1:8000;   #将请求转发重定向到127.0.0.1的8000端口
        include /etc/nginx/uwsgi_params;  #将所有的参数转到uwsgi下
    }

    location ^~/apiCutter/ {
        rewrite ^/apiCutter/(.*) /$1 break;
        uwsgi_pass 127.0.0.1:8001;   #将请求转发重定向到127.0.0.1的8001端口
        include /etc/nginx/uwsgi_params;  #将所有的参数转到uwsgi下
    }

    location ^~/toolsApi/ {
        rewrite ^/toolsApi/(.*) /$1 break;
        uwsgi_pass 127.0.0.1:8003;   #将请求转发重定向到127.0.0.1的8003端口
        include /etc/nginx/uwsgi_params;  #将所有的参数转到uwsgi下
    }

    location ^~/aliyun-api/ {
        proxy_pass http://nls-gateway-cn-shanghai.aliyuncs.com;   #阿里云;
        rewrite ^/aliyun-api/(.*) /$1 break;
    }

    location ^~/happyApi/ {
        # rewrite ^/happyApi/(.*) /$1 break;
        # uwsgi_pass 127.0.0.1:8004;   #将请求转发重定向到127.0.0.1的8003端口
        # include /etc/nginx/uwsgi_params;  #将所有的参数转到uwsgi下
        proxy_pass http://127.0.0.1:8004;  # 将HTTP请求代理到Daphne的HTTP接口
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        rewrite ^/happyApi/(.*) /$1 break;
    }

    location ^~/miniHomeApi/ {
        proxy_pass http://127.0.0.1:8002;  # 将HTTP请求代理到Daphne的HTTP接口
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        rewrite ^/miniHomeApi/(.*) /$1 break;
    }

    # websocket 接口
    location /ws {
        proxy_pass http://127.0.0.1:8004;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;

        proxy_read_timeout 300s;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
       
    }

    # location ^~/family_static/ {
    #     #root static文件夹所在绝对路径,示例如下:
    #     root /root/webroot/family-origin-server/family_static; # 重定向,自动找到static目录
    # }
}